<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="">
    <meta property="og:title" content="Explanation on DB2 Explain">
    
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2012-01-19">
    
    <meta property="og:description" content="">
    <meta property="og:url" content="http://purusothaman.me/explanation-on-db2-explain/">
    <meta property="og:site_name" content="Purusothaman Ramanujam">
    
    <meta name="generator" content="Hugo 0.21" />
    <title>Explanation on DB2 Explain &middot; Purusothaman Ramanujam</title>
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="stylesheet" href="http://purusothaman.me/css/style.css">
    
    <link href="http://purusothaman.me/index.xml" rel="alternate" type="application/rss+xml" title="Purusothaman Ramanujam" />
    
    
    <link rel="icon" href="http://purusothaman.me/favicon.ico" />
    

    
    
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="http://purusothaman.me/">Purusothaman Ramanujam</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		<div id="menu" class="hidden-xs col-sm-4 col-md-3">
	<div id="menu-content" class="vertical-align">
		
			<h1 class="text-center"><a href="http://purusothaman.me/">Purusothaman Ramanujam</a></h1>
		
		
		
			<small class="text-center center-block">My Personal Flavour</small>
		
		
		
			<img id="profile-pic" src="http://purusothaman.me//img/avatar.jpg" alt="My Picture" class="img-circle center-block">
		
		<div id="social" class="text-center">
			
				<a href="https://github.com/purus"><i class="fa fa-github fa-2x"></i></a>
			

			<a href="mailto:purushoth.r@gmail.com"><i class="fa fa-envelope-o fa-2x"></i></a>
		</div>
		<div id="links" class="text-center">
			
			
		</div>
	</div>
</div>

		<div id="content" class="col-xs-12 col-sm-8 col-md-9">
			<div class="row">
				<div id="post" class="col-sm-offset-1 col-sm-10 col-md-10 col-lg-8">

<main>
	<header>
		<h1>Explanation on DB2 Explain</h1>
	</header>

	<article>
		<p>When an SQL is executed against or bound to a DB2 database, DB2 Optimizer tool defines the access path used to access the data. This access path is defined according to tables’ statistics generated by DB2 Runstats tool.</p>

<p>The Explain command details the access path defined by DB2 and allows you to analyze how the data will be accessed and how you can improve the command’s performance.</p>

<p>A table called PLAN_TABLE which has your user id as its owner is required for working on DB2 Explain. You can create it by using the below SQL.</p>

<blockquote>
<p>CREATE TABLE [userid].PLAN_TABLE LIKE DEFAULT.PLAN_TABLE;</p>
</blockquote>

<p>Once the above mentioned table is ready, follow the below steps.</p>

<p><strong>Step One</strong>:</p>

<p>Execute the Explain command on your general SQL statement which you want to analyze:</p>

<blockquote>
<p>EXPLAIN PLAN SET QUERYNO = 1 FOR
[your sql statement here]</p>
</blockquote>

<p>This command will put the Explain information in the PLAN_TABLE.</p>

<p><strong>Step Two</strong>:</p>

<p>Execute this SQL command to view the Explain information:</p>

<blockquote>
<p>SELECT *
FROM PLAN_TABLE
WHERE
QUERYNO = 1
ORDER BY TIMESTAMP, QUERYNO, QBLOCKNO, PLANNO, MIXOPSEQ
WITH UR;</p>
</blockquote>

<p>QUERYNO should be the same used in the explain command on Step 1.</p>

<p><strong>Step Three</strong>:</p>

<p>Look at these fields for important information:</p>

<ul>
<li>PLANNO – Number of steps necessary to process the query indicated in QBLOCKNO.</li>
<li>METHOD – Indicate joins method used for the step (PLANNO).</li>
<li>ACCESTYPE – Method used to access the table.</li>
<li>MATCHCOLS – Number of index key used for index scan (when ACCESTYPE is I, IN, M, MX).</li>
<li>ACCESSNAME – Name of the index used for index scan (when ACCESTYPE is I, IN, M, MX).</li>
<li>INDEXONLY – Indicates if the index alone is enough to carry out the step.</li>
<li>PREFETCH – Indicates if data pages can be read in advance by prefetch.</li>
<li>COLUMN_FN_EVAL – Indicates when aggregate functions are evaluated.</li>
</ul>

<p><strong>Step Four</strong>:
Analyze the results using the following tips:
- Is data accessed through an index?</p>

<p><strong>ACCESSTYPE</strong>:</p>

<ul>
<li>I – Index. This is the best access after the one-fetch index. It uses the index to retrieve rows. The number of index columns used for matching is represented in MATCHCOLS.</li>
<li>I1 – One-fetch index access. Is the best access possible as it requires retrieving only one row. However, it applies only to statement with a MAX or MIN function.</li>
<li>N – Index scan with IN keyword in the predicate. In the example: T(IC1, IC2, IC3, IC4). Command: Select * from T where IC1 = 1 AND IC2 (in 1,2,3) AND IC3 &gt; 0 and IC4 = 1. MATCHCOLS will be 3 and ACCESSTYPE will be N. The IN-List scan will be performed as three matching index scan: (IC=1, IC2=1, IC3&gt;0), (IC=1, IC2=2, IC3&gt;0) and (IC=1, IC2=3, IC3&gt;0). If parallelism is supported they will execute in parallel.</li>
<li>MX – Multiple index scan. More than one index is used to access a table. It is an efficient access path when no single index is efficient and a combination of index provides efficient access.</li>
<li>R – Table space scan. This is the worst type of access as the entire table will be searched to process the query.</li>
</ul>

<p><strong>MATCHCOLS</strong>:
The number of index columns matched on an index scan.</p>

<ul>
<li>If it is 0 all index keys and RIDs are read.</li>
<li>If one of the matching predicates is a range there will be no more matching columns. Example for the index on T(IC1, IC2, IC3, IC4) for the following command the IC3 predicate won’t be used: Select * from T where IC1=1 and IC2 &gt; 1 and IC3 = 1. The position of the columns in the index is used to decide that IC3 won’t be used.</li>
</ul>

<p><strong>INDEXONLY</strong> :
If the columns needed for a SQL statement can be found in the index DB2 will not access the table. INDEXONLY performance is very high.</p>

<p><strong>PREFETCH</strong>:
Prefetching determines in advance if a set of data pages is about to be used and then reads the entire set into a buffer with a single asynchronous I/O operation.</p>

<ul>
<li>S – Sequential prefetch: data pages read in advance are accessed sequentially. Table space scan always uses sequential prefetch.</li>
<li>L – List prefetch: one or more indexes are used to select the RIDs list in advance.</li>
<li>D =- Dynamic prefetch: the pages to be accessed will be non sequential.</li>
<li>Blank – Prefetch not expected.</li>
</ul>

<p><strong>SORTs</strong>:
They add an extra step to the accessed data.</p>

<ul>
<li>METHOD=3 – These sorts are used for ORDER BY, GROUP BY, SELECT DISTINCT or UNION.</li>
<li>SORTC_UNIQUE, SORTC_ORDERBY, SORTC_GROUP_BY – Indicates an extra sort for an UNIQUE, ORDER BY and GROUP BY clause.</li>
</ul>

<p>In order to create necessary tables, it’s better to run</p>

<blockquote>
<p>CALL SYSPROC.SYSINSTALLOBJECTS(‘EXPLAIN’,’C’,NULL,CURRENT SCHEMA)</p>
</blockquote>

	</article>
</main>

<div id="bottom-nav" class="text-center center-block">
	<a href=" http://purusothaman.me/" class="btn btn-default"><i class="fa fa-home"></i> Home</a>
</div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'purusothaman-ramanujam';
    var disqus_identifier = 'http:\/\/purusothaman.me\/explanation-on-db2-explain\/';
    var disqus_title = 'Explanation on DB2 Explain';
    var disqus_url = 'http:\/\/purusothaman.me\/explanation-on-db2-explain\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


						</div>
					</div>
				</div>
			</div>
		</div>
  </div>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42031335-1', 'auto');
    ga('send', 'pageview');
    window.baseURL = "http:\/\/purusothaman.me\/";
  </script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  
  
  <script src="http://purusothaman.me//js/App.js"></script>
  
</body>
</html>
